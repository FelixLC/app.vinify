<ion-view title="Vinibar">
	<ion-nav-buttons side="right">
		<button class="button" ng-click="search.toggle = !search.toggle">
			<i class="icon ion-search"></i>
		</button>
	</ion-nav-buttons>
	<ion-header-bar align-title="left" class="bar-positive bar-subheader bar-segmented-control">
		<p ng-if="!search.toggle" class="segmented-control">
				<span class="segmented">
						<label><input type="radio" name="list" ng-model="segmentedControl.value" value="toDrink" checked><span class="label">A boire</span></label>
						<label><input type="radio" name="list" ng-model="segmentedControl.value" value="rated"><span class="label">Notés</span></label>
				</span>
		</p>
		<div ng-if="search.toggle" class="item-input-inset search-vinibar">
			<label class="item-input-wrapper">
				<i class="icon ion-ios7-search placeholder-icon"></i>
				<input type="search" ng-model="search.value" placeholder="Search">
			</label>
			<button class="button-clear" ng-click="search.value = '' ">
				Annuler
			</button>
		</div>
	</ion-header-bar>
	<ion-content overflow-scroll="true" class="has-subheader">

		<a ng-if="user.awaiting_order" class="item centered" ng-click="orderReceived()">
			<h3>Une commande est en route !</h3>
			<p>Cliquez ici si vous l'avez reçue</p>
		</a>
		<a  ng-if="user.status == 1" class="item centered" ng-click="questionnaire()">
			<h3>Vous n'avez pas encore de vinibar !</h3>
			<p>Cliquez ici pour démarrer l'aventure</p>
		</a>
		<a  ng-if="user.status == 2 || user.status == 2.5" class="item centered" ng-click="payOrder()">
			<h3>Vous n'avez pas finalisé votre commande !</h3>
			<p>Cliquez ici pour continuer l'aventure</p>
		</a>
		<ion-list ng-if="segmentedControl.value === 'rated'">
			<a ng-repeat="bottle in bottleList.results | filter: {date_rated: '!null'}  | filter: searchFilter" class="item" href="#/ratedwine/{{::bottle.uuid}}">
					<h3>{{::bottle.wine.display_name}}</h3>
					<p class="vinitext">
							{{::bottle.wine.region}}
							<span class="item-note">
								<i ng-repeat="i in getNumber(bottle.rating) track by $index" class="icon ion-ios7-star full-star"></i>
								<i ng-hide="isInteger(bottle.rating)" class="icon ion-ios7-star-half full-star"></i>
							</span>
							<br>
							{{::bottle.wine.appellation}}
					</p>
			</a>
		</ion-list>
		<ion-list ng-if="segmentedControl.value === 'toDrink'">
			<a ng-repeat="bottle in bottleList.results | filter: {date_rated: 'null'}  | filter: searchFilter" class="item" href="#/wine/{{::bottle.uuid}}">
					<h3>{{::bottle.wine.display_name}}</h3>
					<p class="vinitext">
							{{::bottle.wine.region}}
							<span class="item-note">{{::bottle.wine.vintage}}</span>
							<br>
							{{::bottle.wine.appellation}}
						</p>
			</a>
		</ion-list>
	</ion-content>
</ion-view>